@model AllEmailsViewModel

<ul class="nav nav-tabs">
    @if (Model.ActiveTab == Constants.TabAll)
    {
        <li class="nav-item">
            <a class="nav-link active" asp-controller="Email" asp-action="Index">All Emails</a>
        </li>
    }
    else
    {
        <li class="nav-item">
            <a class="nav-link" asp-controller="Email" asp-action="Index">All Emails</a>
        </li>
    }

    @if (Model.ActiveTab == Constants.TabNew)
    {
        <li class="nav-item">
            <a class="nav-link active" asp-controller="Email" asp-action="GetNewEmails">New Emails</a>
        </li>
    }
    else
    {
        <li class="nav-item">
            <a class="nav-link" asp-controller="Email" asp-action="GetNewEmails">New Emails</a>
        </li>
    }

    @if (Model.ActiveTab == Constants.TabOpen)
    {
        <li class="nav-item">
            <a class="nav-link active" asp-controller="Email" asp-action="GetOpenEmails">Open Applications</a>
        </li>
    }
    else
    {
        <li class="nav-item">
            <a class="nav-link" asp-controller="Email" asp-action="GetOpenEmails">Open Applications</a>
        </li>
    }

    @if (Model.ActiveTab == Constants.TabClosed)
    {
        <li class="nav-item">
            <a class="nav-link active" asp-controller="Email" asp-action="GetClosedEmails">Closed Applications</a>
        </li>
    }
    else
    {
        <li class="nav-item">
            <a class="nav-link" asp-controller="Email" asp-action="GetClosedEmails">Closed Applications</a>
        </li>
    }
</ul>

<table class="table table-hover">
    <thead class="thead-light">
        <tr>
            <th scope="col">ID</th>

            @if (Model.ActiveTab == Constants.TabAll)
            {
                <th scope="col">
                    <a asp-action="Index" asp-route-sortOrder="@ViewData["DateSortParm"]">Received</a>
                </th>
            }
            else if (Model.ActiveTab == Constants.TabNew)
            {
                <th scope="col">
                    <a asp-action="GetNewEmails" asp-route-sortOrder="@ViewData["DateSortParm"]">Received</a>
                </th>
            }
            else if (Model.ActiveTab == Constants.TabOpen)
            {
                <th scope="col">
                    <a asp-action="GetOpenEmails" asp-route-sortOrder="@ViewData["DateSortParm"]">Received</a>
                </th>
            }
            else if (Model.ActiveTab == Constants.TabClosed)
            {
                <th scope="col">
                    <a asp-action="GetClosedEmails" asp-route-sortOrder="@ViewData["DateSortParm"]">Received</a>
                </th>
            }

            <th scope="col">Email</th>
            <th scope="col">Name</th>
            <th scope="col">Subject</th>

            @if (Model.ActiveTab == Constants.TabAll)
            {
                <th scope="col">Status</th>
                <th scope="col">Attachments</th>
                <th scope="col">Preview</th>
                <th scope="col">Change Status</th>

            }

            @if (Model.ActiveTab == Constants.TabNew)
            {
                <th scope="col">
                    <a asp-action="GetNewEmails" asp-route-sortOrder="@ViewData["SinceStatus"]">New since</a>
                </th>

                <th scope="col">Preview</th>
            }

            @if (Model.ActiveTab == Constants.TabOpen)
            {
                <th scope="col">
                    <a asp-action="GetOpenEmails" asp-route-sortOrder="@ViewData["SinceStatus"]">Open since</a>
                </th>

                @if (User.IsInRole(Constants.Manager))
                {
                    <th scope="col">Open by</th>
                }

                <th scope="col">Preview</th>
            }

            @if (Model.ActiveTab == Constants.TabClosed)
            {
                <th scope="col">Status</th>
                @if (User.IsInRole(Constants.Manager))
                {
                    <th scope="col">Closed by</th>
                }
                <th scope="col">Preview</th>
            }
        </tr>
    </thead>
    <tbody>
        @foreach (var email in Model.AllEmails)
        {
            if (Model.ActiveTab == Constants.TabAll)
            {
                <partial name="_AllEmailPartial" model="email" />
            }
            else if (Model.ActiveTab == Constants.TabNew)
            {
                <partial name="_NewEmailPartial" model="email" />
            }
            else if (Model.ActiveTab == Constants.TabOpen)
            {
                <partial name="_OpenEmailPartial" model="email" />
            }
            else if (Model.ActiveTab == Constants.TabClosed)
            {
                <partial name="_ClosedEmailPartial" model="email" />
            }
        }

    </tbody>
</table>

